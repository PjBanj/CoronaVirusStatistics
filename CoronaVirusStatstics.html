<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
	
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	
<title>Corona Virus</title>

<style>
	.inBlock {
		display:inline-block;
	}
</style>

</head>
<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
<script type="module" src="https://cdnjs.cloudflare.com/ajax/libs/fetch/3.0.0/fetch.js"></script>
<div class = "container">
	<div class="row">
		<div class="col-xs-8">
		<h2 align='center'>CoronaVirus cases in the United States March 2nd to April 2nd</h2>
			<canvas id="CoronaChartCases" width="450" height="450"></canvas>
		</div>
	</div>
</div>
<div class = "container">
	<div class="row">
		<div class="col-xs-12" class="text-center">
			<input class="col-xs-4" type="text" name="state" id="state"><br>
			<button class="col-xs-4" onclick="chartStateCases(document.getElementById('state').value)">Show Graph for State</button>
		</div>
	</div>
</div>	
<!-- <div class="container"> -->
  <!-- <div class="row"> -->
    <!-- <div class="col-xs-6" class="text-center"> -->
      <!-- <canvas id="CoronaChartCTCases" width="400" height="400"></canvas> -->
    <!-- </div> -->
    <!-- <div class="col-xs-6" class="text-center"> -->
      <!-- <canvas id="CoronaChartCTDeaths" width="400" height="400"></canvas> -->
    <!-- </div> -->
  <!-- </div> -->
  <!-- <canvas id="canvas"></canvas> -->
<!-- </div> -->

<div class="col-xs-8" class="inBlock">
	<canvas id="CoronaChartCTCases" width="450" height="450"></canvas>
	<canvas id="CoronaChartCTDeaths" width="450" height="450"></canvas>
</div> 
 
<script>
	var cases = [];
	var deaths = [];
	var days = [];
	const xlabels=[1,2,3,4,5,6,7, 8,9, 10, 11, 12, 13, 14 , 15, 16, 17, 18, 19, 20, 21 , 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32];
	const ytemps=[53, 80, 98, 164, 214, 279, 423, 647, 937, 1215, 1629, 1896, 2234, 3487, 4226, 7038, 10442, 15219, 18747, 24583, 33404,	44183, 54453, 68440, 85356, 103321, 122653,	140904,	163539,	186101,	213144,	239279];
	chartIt();


	function chartStateCases(state) {
		getData(state);
		console.log(cases);
		console.log(deaths);
		console.log(days);
		chartItCTCases();
		chartItCTDeaths();
	}

	function chartIt() {
		var ctx = document.getElementById('CoronaChartCases').getContext('2d');
		var myChart = new Chart(ctx, {
			type: 'bar',
			data: {
				labels: xlabels,
				datasets: [{
				  label: 'Cases',
				  data: ytemps,
				  backgroundColor: "rgba(153,255,51,0.4)"
				}]
			}
		});
	}

	function chartItCTCases() {
		var ctx = document.getElementById('CoronaChartCTCases').getContext('2d');
		var myChart = new Chart(ctx, {
			type: 'bar',
			data: {
				labels: days,
				datasets: [{
				  label: 'Cases',
				  data: cases,
				  backgroundColor: "rgba(153,255,51,0.4)"
				}]
			}
		});
	}

	function chartItCTDeaths() {
		var ctx = document.getElementById('CoronaChartCTDeaths').getContext('2d');
		var myChart = new Chart(ctx, {
			type: 'bar',
			data: {
			labels: days,
			datasets: [{
			  label: 'Deaths',
			  data: deaths,
			  backgroundColor: "rgba(153,255,51,0.4)"
			}]
		  }
		});
	}

	function getData(state) { 
		cases = [];
		deaths = [];
		days = [];
		fetch('https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv')
		.then((response) => {
			return response.text(); 
		})
		.then((data) => {
			const table = data.split('\n').slice(1);
			curDay = 0;
			table.forEach((row) => { 
				const columns = row.split(','); 
				if(columns[1]==state) {
					cases.push(columns[3]);
					deaths.push(columns[4]);
					days.push(curDay++);
				}
			});
		});
}
</script>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

</body>
</html>